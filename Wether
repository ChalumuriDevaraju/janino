import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;

public class WeatherApp {
    public static void main(String[] args) {
        try {
            String apiKey = "YOUR_API_KEY"; // Replace this with your actual API key from OpenWeatherMap
            String city = getUserInput("Enter the name of the city: ");
            String apiUrl = "http://api.openweathermap.org/data/2.5/weather?q=" + city + "&appid=" + apiKey;

            String jsonData = fetchDataFromApi(apiUrl);

            if (jsonData != null) {
                displayWeatherData(jsonData, city);
            } else {
                System.out.println("City not found or API error. Please try again.");
            }
        } catch (IOException e) {
            System.out.println("An error occurred: " + e.getMessage());
        }
    }

    private static String getUserInput(String prompt) throws IOException {
        System.out.print(prompt);
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        return br.readLine();
    }

    private static String fetchDataFromApi(String apiUrl) throws IOException {
        StringBuilder result = new StringBuilder();
        URL url = new URL(apiUrl);
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setRequestMethod("GET");

        BufferedReader reader = new BufferedReader(new InputStreamReader(connection.getInputStream()));
        String line;
        while ((line = reader.readLine()) != null) {
            result.append(line);
        }
        reader.close();
        return result.toString();
    }

    private static void displayWeatherData(String jsonData, String city) throws IOException {
        ObjectMapper objectMapper = new ObjectMapper();
        JsonNode rootNode = objectMapper.readTree(jsonData);

        String weatherDescription = rootNode.get("weather").get(0).get("description").asText();
        double temperature = rootNode.get("main").get("temp").asDouble();
        double windSpeed = rootNode.get("wind").get("speed").asDouble();
        double pressure = rootNode.get("main").get("pressure").asDouble();

        System.out.println("\nWeather Report for " + city + ":");
        System.out.println("Weather Description: " + weatherDescription);
        System.out.println("Temperature: " + temperature + " Kelvin");
        System.out.println("Wind Speed: " + windSpeed + " meter/sec");
        System.out.println("Pressure: " + pressure + " hPa");
    }
}
